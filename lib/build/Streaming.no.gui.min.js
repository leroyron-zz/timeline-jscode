/**
 * Streaming gui timeline theme (Optimal - no charts, inserting, dialogs and vscode authority no settings, no timeline...)
 * @author leroyron / http://leroy.ron@gmail.com
 */
(function(d,m){this.gui={};this.gui.addon={bind:{}};this.gui.addon={bind:{}};this.gui.addon.bind.onchange=function(a,b){a.onChange(function(a){b(this)})};var g=function(a,b,d){a[b]||(a[b]=function(){this[b+"Callbacks"]()});a[b+"Calls"]=[];a[d]=0;a[b+"Callbacks"]=function(){for(var a=0;a<this[d];a++)this[b+"Calls"][a][1](this[b+"Calls"][a][0])}};this.gui.addon.bind.oninit=function(a,b,d){b.initCalls||g(b,"init","inclen");b.initCalls.push([a,d]);b.inclen++};this.gui.addon.bind.onready=function(a,b,d){b.readyCalls||g(b,"ready","rdclen");b.readyCalls.push([a,d]);b.rdclen++};this.gui.addon.bind.onupdate=function(a,b,d){b.updateCalls||g(b,"update","upclen");b.updateCalls.push([a,d]);b.upclen++};this.gui.addon.bind.onruntime=function(a,b,d){b.runtimeCalls||g(b,"runtime","ruclen");b.runtimeCalls.push([a,d]);b.ruclen++};this.gui.addon.bind.onrevert=function(a,b,d){b.revertCalls||g(b,"revert","rrclen");b.revertCalls.push([a,d]);b.rrclen++};this.gui.addon.bind.onpass=function(a,b,d){b.passCalls||g(b,"pass","paclen");b.passCalls.push([a,d]);b.paclen++};m(this.gui,this.Streaming,this.app)})(this.dat,function(d,m,g){d.addon.app=function(a){var b={};a.fullScreenHandler="undefined"!=typeof document.fullscreenElement?{event:"fullscreenChange",state:"fullscreen"}:"undefined"!=typeof document.msFullscreenElement?{event:"MSFullscreenChange",state:"fullscreen"}:"undefined"!=typeof document.mozFullScreenElement?{event:"mozfullscreenchange",state:"mozFullScreen"}:"undefined"!=typeof document.webkitFullscreenElement?{event:"webkitfullscreenchange",state:"webkitIsFullScreen"}:{event:"fullscreenchange",state:"fullscreen"};document.addEventListener(a.fullScreenHandler.event,function(c){c.preventDefault();a.fullscreenEnabled=document[a.fullScreenHandler.state];b.fullscreen.setValue(a.fullscreenEnabled);window.setTimeout(window.onresize(),1E3)},!1);b.resolution={r2160p:[3840,2160],r1440p:[2560,1440],r1080p:[1920,1080],r720p:[1280,720],r480p:[854,480],r360p:[640,360],r240p:[426,240]};g.resolution.update=function(a){window.changeResolution({width:b.resolution[a][0],height:b.resolution[a][1]})}("r720p");return b}(d);d.addon.Streaming=d.addon.Streaming=m.prototype.addon;var a=d.addon.Streaming.timeframe,b=d.addon.Streaming.timeframe.timeline=function(b,d){var c={segment:0,init:void 0,ready:void 0,update:function(a){c.updateCallbacks()},updateCalls:[],upclen:0,updateCallbacks:function(){for(var a=0;a<this.upclen;a++)this.updateCalls[a][1](this.updateCalls[a][0])},pass:function(a){c.passCallbacks()},passCalls:[],paclen:0,passCallbacks:function(){for(var a=0;a<this.paclen;a++)this.passCalls[a][1](this.passCalls[a][0])}},f=function(){a.duration>a.length&&(a.duration+=a.length-a.duration);c.seek.position=a.duration/a.length*100;c.seek.position-c.prevSegmentPos>c.segmentPos-c.prevSegmentPos&&c.checkPassSegment();c.update()};c.seek={position:void 0,slider:{},span:{},bar:{},info:{}};c.prevSegmentPos=void 0;c.segmentPos=void 0;c.nextSegmentPos=void 0;c.passSegment=void 0;c.callbackPass={list:[],count:0};var h,e,g,x,u,r,y,k,t,m,v,p,q,n;c.refresh=function(){h=document.getElementById("actionjson");e=document.getElementsByClassName("actionscript");g=e.length;x=new Int32Array(new ArrayBuffer(4*g));for(var a=0;a<g;a++)x[a]=parseInt(e[a].data);u=document.getElementById("soundjson");r=document.getElementsByClassName("soundscript");y=r.length;k=document.getElementById("commentjson");t=document.getElementsByClassName("commentscript");m=t.length;v=document.getElementById("segmentjson");p=document.getElementsByClassName("segmentscript");q=p.length;n=new Int32Array(new ArrayBuffer(4*q));for(a=0;a<q;a++)n[a]=parseInt(p[a].data)||1;this.checkPassSegment()};c.checkPassSegment=function(){for(var a=this.passSegment=0;a<q;a++)this.seek.position>=n[a]&&this.passSegment++;this.prevSegmentPos=n[this.segment-1]||0;this.segmentPos=n[this.segment]||100;this.nextSegmentPos=n[this.segment+1]||100;this.pass()};c.destroy=function(){a.clearRuntimeAuthority("action");a.clearRuntimeAuthority("sound");a.clearRuntimeAuthority("comment");a.clearRuntimeAuthority("segment");for(var b=g-1;-1<b;b--)e[b]&&document.getElementsByTagName("body")[0].removeChild(e[b]);for(b=y-1;-1<b;b--)r[b]&&document.getElementsByTagName("body")[0].removeChild(r[b]);for(b=m-1;-1<b;b--)t[b]&&document.getElementsByTagName("body")[0].removeChild(t[b]);for(b=q-1;-1<b;b--)p[b]&&document.getElementsByTagName("body")[0].removeChild(p[b]);h&&document.getElementsByTagName("body")[0].removeChild(h);u&&document.getElementsByTagName("body")[0].removeChild(u);k&&document.getElementsByTagName("body")[0].removeChild(k);v&&document.getElementsByTagName("body")[0].removeChild(v);this.refresh()};c.destroy();var l=document.getElementsByClassName("rec");window.clearInterval(window.interval);window.interval=window.setInterval(function(){for(var a=0;a<l.length;a++)"rec on"==l[a].className?l[a].className="rec off":"rec off"==l[a].className?l[a].className="rec on":"rec seg"==l[a].className&&(l[a].innerHTML=c.segment)},1E3);var w=function(){setTimeout(function(){if(a.init&&c.init){4!=c.initCalls.length&&w();c.init();var b=function(){setTimeout(function(){a.ready&&c.ready?(this.app.ready=!0,c.ready()):b()},0)};b()}else w()},0)};w();b.addon.bind.onrevert(c.seek,a,function(b,d){a.duration=d;f();a.syncing();c.checkPassSegment()});b.addon.bind.onruntime(c.seek,a,f);return c}(d,g);(function(d){var f=d.addon.Streaming.timeframe.timeline.seek;a.goTo=function(c){a.duration=c||f.position/100*a.length<<0;a.syncing();b.checkPassSegment()};d.addon.bind.onready(f,b,function(){setTimeout(function(){a.run()},500)});return f})(d);var k=d.addon.Streaming.timeframe.timeline.seek.insert=function(d,f){var c={select:"nothing",delta:"nothing",position:{},dragging:!1},g=function(b,c,d,f,g){var e=document.createElement("script");e.type="text/javascript";e.async=!1;g?e.id=b+"json":(e.setAttribute("class",b+"script"),e.data=f);e.readyState?e.onreadystatechange=function(){if("loaded"==e.readyState||"complete"==e.readyState)e.onreadystatechange=null,d(window.Authority,b,f),window.Authority=void 0,h.finish++,h.entry==h.finish&&a._ready()}:e.onload=function(){d(window.Authority,b,f);window.Authority=void 0;h.finish++;h.entry==h.finish&&a._ready()};e.src=c;document.getElementsByTagName("body")[0].appendChild(e)},h={entry:0,finish:0};c.load=function(a,b,c){var d=c||"";f.codesettingLoc=f.codesetting?f.codesetting+"/":"";h.entry++;g(a,d+("user/"+f.codesettingLoc+a),function(c){for(var e in c)h.entry++,g(a,d+("user/"+f.codesettingLoc+a+e+".js"),b,e,!1)},0,!0)};c.reload=function(a,b,c){this.load("action",this.action.init,f.vscode._fileLocal);this.load("sound",this.sound.init,f.vscode._fileLocal);this.load("comment",this.comment.init,f.vscode._fileLocal);this.load("segment",this.segment.init,f.vscode._fileLocal)};c.insertAuthorities=function(c){for(var d in c){this.delta=d;for(var e in c[d])this.position=e/a.length*100,a.runtimeAuthority(c[d][e].Authority,this.delta,e)}b.refresh();this.select=this.delta="nothing"};return c}(d,g);d.addon.Streaming.timeframe.timeline.seek.insert.comment=function(d,f){var c={init:function(c,d,e){a.runtimeAuthority(c,d,e);b.refresh()}};d.addon.bind.oninit(c,b,function(a){k.load("comment",a.init,f.vscode._fileLocal)});return c}(d,g);d.addon.Streaming.timeframe.timeline.seek.insert.segment=function(d,f){var c={init:function(c,d,e){a.runtimeAuthority(c,d,e);b.refresh()}};d.addon.bind.oninit(c,b,function(a){k.load("segment",a.init,f.vscode._fileLocal)});return c}(d,g);d.addon.Streaming.timeframe.timeline.seek.insert.action=function(d,f){var c={init:function(c,d,e){a.runtimeAuthority(c,d,e);b.refresh()}};d.addon.bind.oninit(c,b,function(a){k.load("action",a.init,f.vscode._fileLocal)});return c}(d,g);d.addon.Streaming.timeframe.timeline.seek.insert.sound=function(d,f){var c={init:function(c,d,e){a.runtimeAuthority(c,d,e);b.refresh()}};d.addon.bind.oninit(c,b,function(a){k.load("sound",a.init,f.vscode._fileLocal)});return c}(d,g)});