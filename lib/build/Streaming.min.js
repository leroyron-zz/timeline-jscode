/**
 * Streaming
 * @author leroyron / http://leroy.ron@gmail.com
 * //Streaming for javascript's linear parallelity
 */
var Streaming=function(S){Streaming=function(k){this.open=this.open||function(){this.build=function(g){try{this.stream=this.bindings.stream,this.nodesPerStream=this.bindings.nodesPerStream,this.propsPerNode=this.bindings.propsPerNode,this.propsPerNodeList=this.bindings.propsPerNodeList,this.propDataLength=this.bindings.propDataLength,this.continuancePosValData0=1,this.data0PropDataLength=this.continuancePosValData0+this.propDataLength,this.nodeDataLength=this.data0PropDataLength*this.propsPerNode+
this.propsPerNode+1,this.data=this._prebuff(this.bindings.data),this.bindings.stream=this.bindings.nodesPerStream=this.bindings.propsPerNode=this.bindings.propsPerNodeList=this.bindings.propDataLength=this.bindings.data=null,delete this.bindings.stream,delete this.bindings.nodesPerStream,delete this.bindings.propsPerNode,delete this.bindings.propsPerNodeList,delete this.bindings.propDataLength,delete this.bindings.state,delete this.bindings.data,this._finalize(g)}catch(T){console.log("Streaming: No bindings - ref: http://")}finally{console.log("Streaming - "),
console.log("Like what you see? Are you a dev? We need people like you! https://github.com/leroyron/timeline-jscode")}};this.access=this.access||function(g,k,P,M,D,a,f,c){var l=g,m=k,J=P,A=M,e=D,d=a,b=f,n=c;this.defaults={};this.nextRuntimeCallback=this.mCount=this.tCount=this.rCount=0;this.runtimeCalls=[];this.ruclen=0;this.runtimeCallbacks=function(b){for(var a=y,d,e=0;e<this.ruclen;e++)(d=this.runtimeCalls[e][1](this.runtimeCalls[e][0]||this.nextRuntimeCallback,b,0))&&
d<a&&(a=d);this.nextRuntimeCallback=a;this.block&&(this.rCount=this.tCount=this.block=0);this.runtimeCallbacks=p};var p=function(b){if(!(b+this.data[2]<=this.nextRuntimeCallback||b+this.data[2]>y)){for(var a=y,d,e=0;e<this.ruclen;e++)(d=this.runtimeCalls[e][1](this.runtimeCalls[e][0]||this.nextRuntimeCallback,b,this.data[2]))&&d<a&&(a=d);this.nextRuntimeCallback=a;this.block&&(this.rCount=this.tCount=this.block=0)}};this.revertCalls=[];this.rrclen=0;this.revertCallbacks=function(b,a){for(var d=y,
e,c=0;c<this.rrclen;c++)(e=this.revertCalls[c][1](this.revertCalls[c][0]||b,a))&&e<d&&(d=e);this.nextRuntimeCallback=d;this.syncOffsets(b)};this.update=function(a,c,h,f,p,y,g,E){l=a;m=c;J=h;A=f;e=p;d=y;b=g;n=E;this.updateCallbacks()};this.updateCalls=[];this.upclen=0;this.updateCallbacks=function(){for(var b=0;b<this.upclen;b++)this.updateCalls[b][1](this.updateCalls[b][0])};var t="stream",E,B,C,y,K,w,O,v;this._finalize=function(b){t=this.stream;E=this.nodesPerStream;B=this.propsPerNode;C=this._prebuff(this.propsPerNodeList);
y=this.propDataLength;K=this.continuancePosValData0;w=this.data0PropDataLength;O=this.nodeDataLength;this.nodesPerStream=this.propsPerNode=this.data0PropDataLength=delete this.nodesPerStream;delete this.propsPerNode;delete this.propsPerNodeList;delete this.data0PropDataLength;v=this.data.length;this.updateCallbacks();b()};this.revertFromTo=function(b,a){this.propDataLength=y=b;this.continuancePosValData0=K=a+1};this.reversion=function(b){return b-y*(b/y<<0)+K};this.method=this.option="Change the streaming process";
this.process=function(b,a,e){switch(this.option){case "thrust":this.tCount=b+A;this.runtimeCallbacks(this.tCount);switch(this.method){case "all":this._thrustAll(this.tCount);break;case "nodes":this._thrustNodes(this.tCount,e);break;case "properties":this._thrustProperties(this.tCount,e);break;case "mix":this._thrustMix(this.tCount,e);break;default:this._thrustAll(this.tCount)}break;case "read":this.rCount=b+J;this.runtimeCallbacks(this.rCount);switch(this.method){case "all":this._readAll(this.rCount);
break;case "nodes":this._readNodes(this.rCount,e);break;case "properties":this._readProperties(this.rCount,e);break;case "mix":this._readMix(this.rCount,e);break;default:this._readAll(this.rCount)}break;case "measure":switch(this.mCount=b+d,this.runtimeCallbacks(this.mCount),this.method){case "all":return[this._measureAll(this.mCount)];case "nodes":return[this._measureNodes(this.mCount,e)];case "properties":return[this._measureProperties(this.mCount,e)];case "mix":return[this._measureMix(this.mCount,
e)];default:return[this._measureAll(this.mCount)]}}};this.output_utilizeMeasureData=this.output_utilizeThrustData=this.output_utilizeReadData="Data entry portal for execute, ref this to outer functions";var h=0,x=0,r=0,u=0,G=0,I=0,z,q,H,Q=-1,F=0,N=0;this._currentDataPos=function(){return this.data[2]};this._checkInContinuance=function(){if(!l)return h;h+=this.data[q];this._updateDataPos();return h};this._updateDataPos=function(b){b=b||h;z=b-r-I;q=b-z};this._checkOutRevert=function(b){if(!e)return h;
this.data[q]=z=this.reversion(z+(b||m));Q!=z&&(Q=z,this.output_revertCall(K),this.revertCallbacks(K,z),setTimeout(function(){Q=-1},1E3));return z};this.output_revertCall="Data entry portal for execute, ref this to outer functions";this._callOutLeap=function(b){var a=this.bindings.ids["_bi"+F],d=a[N],e=a.node[t][d.binding].leap;e&&(this.data[b]=e.zeroIn||0,e.callback(),e.dispose&&(a.node[t][d.binding].leap=null,delete a.node[t][d.binding].leap))};this._readAll=function(b){for(u=r=G=x=h=0;h<v;h++)if(0==
(h-x)%O&&(F=this.data[h],C[F]&&(h-x!=x&&(x=h,G=h%w,u=0),B=C[F],O=w*B+B+1),h++,r=1,u++),(h-u)%w==G&&(I=h-r,N=this.data[h],h++,r++,u++,z=h-r-I,q=h-z,H=q+(w-z-1),n&&(this.data[q]=K),h=this._checkInContinuance()),-1==F)h=H,this._updateDataPos();else if(0<b)this.output_utilizeReadData(this._dataVal(b),F,N);else break};this._dataVal=function(a){var d=this.data[h],c=z+a,n=q+c;c>y&&e&&(c=this._checkOutRevert(a),h=n=q+c);this.data[n]==b?(l&&(this.data[q]=c),this.data[n]=0):(h=n,this._updateDataPos(),this.data[q]=
z,d=this.data[h]);h=H;this._updateDataPos();return d};this._thrustAll=function(b){for(u=r=h=0;h<v;h++)if(0==h%O&&(F=this.data[h],h++,r=1,u++),0==(h-u)%w&&(I=h-r,N=this.data[h],h++,r++,u++,z=h-r-I,q=h-z,H=q+(w-z-1),n&&(this.data[q]=K),h=this._checkInContinuance()),-1==F)h=H,this._updateDataPos();else if(0<b)this.output_utilizeThrustData(this._dataSum(b),F,N);else break};this._dataSum=function(a){for(var d=0,c=0;c<a;c++){var n=z+1,f=q+n;if(n>y)if(e)c--,n=this._checkOutRevert(1),h=q+n;else break;else if(this.data[f]==
b){l&&(this.data[q]=n);this._callOutLeap(f);break}else h=f,this._updateDataPos(),this.data[q]=z,d+=this.data[h]}h=H;this._updateDataPos();return d};var R=0,L;this._measureAll=function(b){L=new Int32Array(new ArrayBuffer(b*B+B+4*E));for(u=r=h=R=0;h<v;h++)if(0==h%O&&(F=this.data[h],L[R++]=F,h++,r=1,u++),0==(h-u)%w&&(I=h-r,N=this.data[h],L[R++]=N,h++,r++,u++,z=h-r-I,q=h-z,H=q+(w-z-1),n&&(this.data[q]=K),h=this._checkInContinuance()),-1==F)h=H,this._updateDataPos();else if(0<b)this.output_utilizeMeasureData(this._dataReturn(b,
L),F,N);else return;return L};this._dataReturn=function(a,d){for(var c=0;c<a;c++){var n=z+1,f=q+n;if(n>y)if(e)c--,h=q+K,this._updateDataPos();else break;else if(this.data[f]==b){h=H;this._updateDataPos();break}else h=f,this._updateDataPos(),d[R++]=this.data[h]}h=H;this._updateDataPos();return d};this.syncOffsets=function(b){b++;for(u=r=G=x=h=0;h<v;h++)0==(h-x)%O&&(C[this.data[h]]&&(h-x!=x&&(x=h,G=h%w,u=0),B=C[this.data[h]],O=w*B+B+1),h++,r=1,u++),(h-u)%w==G&&(I=h-r,h++,r++,u++,z=h-r-I,q=h-z,H=q+(w-
z-1),n&&(this.data[q]=K),h=this._checkInContinuance(),b>y&&(b=this._checkOutRevert(b))),this.data[q]=b,h=H,this._updateDataPos()};this.arguments={continuance:l,skip:m,rCount:J,tCount:A,revert:e,mCount:d,leap:b,reset:n,_accessed:!0};return this};this._prebuff=function(g){for(var k=g.length,P=new Int32Array(new ArrayBuffer(4*k)),M=0;M<k;M++)P[M]=g[M];return P};this.access.prototype.length=this.length};this.constructor.prototype.length=this.constructor.prototype.length||k;this.open.prototype.length=
this.constructor.prototype.length;return this.open()};S(Streaming);return Streaming}(function(S){var k=S.prototype;k.addon={};k.open=function(){var a=this.open.prototype;a.addon=this.addon;k.open=void 0;var f=new S;f._access=f.access;f._access.prototype.addon=a.addon;f.access=function(){this.access=this._access;var a=this.access.apply(this,arguments),f;for(f in this.addon)for(var g in this.addon[f])if("access"==g)this.addon[f][g]=a;else for(var k in this.addon[f][g])"accessRuntime"==k&&(a.runtimeCalls.push([0,
this.addon[f][g].runtime]),a.ruclen++),"accessRevert"==k&&(a.revertCalls.push([0,this.addon[f][g].revert]),a.rrclen++),"accessUpdate"==k&&(a.updateCalls.push([0,this.addon[f][g].update]),a.upclen++);return a};return f};var g=k.addon.runtime={access:void 0,system:function(){var a=this.constructor,f,c,g,m,k,A,e,d,b,n,p,t;this.update=function(){return this};this.proxy=function(){return this};this.init=function(){return this};this.Pointer=function(){f=a.pointer;this.Pointer=new f;return this};this.Knob=
function(){c=a.knob;this.Knob=new c;return this};this.Subject=function(){g=a.subject;this.Subject=new g;return this};this.Marquee=function(){if(f||c||g)return m=a.marquee,this.Marquee=new m,this;console.log("System Marquee: No - Pointer, Knob or Subject detected")};this.Grid=function(){if(f||c||g)return k=a.grid,this.Grid=new k,this;console.log("System Grid: No - Pointer, Knob or Subject detected")};this.Parallax=function(){if(k)return A=this.Grid.parallax,this.Parallax=new A,this;console.log("System Parallax: No - Grid system detected")};
this.Entity=function(){if(A)return e=this.Parallax.entity,this.Entity=new e,this;console.log("System Entity: No - Parallax system detected")};this.Physic=function(){if(A)return d=this.Parallax.physic,this.Physic=new d,this;console.log("System Physic: No - Parallax system detected")};this.Bound=function(){if(A)return b=this.Parallax.bound,this.Bound=new b,this;console.log("System Bound: No - Parallax system detected")};this.Collision=function(){if(A)return n=this.Parallax.collision,this.Collision=
new n,this;console.log("System Collision: No - Parallax system detected")};this.Particle=function(){if(e||d||b||n)return p=this.Parallax.particle,this.Particle=new p,this;console.log("System Particle: No - Entity, Physic, Bound or Collision detected")};this.Rig=function(){if(e||d||b||n)return t=this.Parallax.rig,this.Rig=new t,this;console.log("System Rig: No - Entity, Physic, Bound or Collision detected")};return this instanceof a?this.That:new a}};k.addon.runtime.system.pointer=function(){var a=
this.constructor,f={},c={},g={};this.bind=function(a,e){f=a;c=e;return this};this.result=function(a){g=a;return this};this.init=function(){c.onmousedown=c.ontouchstart=function(a){a.preventDefault();if(f.enabled)if(a.changedTouches)for(var e=0,d=a.changedTouches.length;e<d;e++)m(!0,f,a.changedTouches[e].identifier,a,this,function(b){g(b)});else m(!1,f,0,a,this,function(b){g(b)})};c.onmousemove=c.ontouchmove=function(a){a.preventDefault();if(f.inUse)if(a.changedTouches)for(var e=0,d=a.changedTouches.length;e<
d;e++)m(!0,f,a.changedTouches[e].identifier,a,this,function(b){g(b)},!0);else m(!1,f,0,a,this,function(b){g(b)},!0);else a.changedTouches||m(!1,f,0,a,this,function(b){g(b)},!0)};c.onmouseup=c.ontouchend=function(a){a.preventDefault();if(f.enabled)if(a.changedTouches)for(var e=0,d=a.changedTouches.length;e<d;e++){if(!k(a.targetTouches,a.changedTouches[e].identifier)){var b=a.changedTouches[e].identifier;m(!0,f,b,a,this,function(b){g(b)});delete f[b]}}else m(!1,f,0,a,this,function(b){g(b)}),f.inUse=
!1,delete f[0]};return this};var m=function(a,e,d,b,c,g,t){e[d]=b;e[d].normal={};e[d].viewport={};if(a)if(b.targetTouches[d])var n=b.targetTouches[d];else if(console.log("touch missed"),b.changedTouches[d])n=b.changedTouches[d];else{console.log("exiting");return}else n=b;e[d].normal.x=(n.pageX-c.offsetLeft)/c.clientWidth;e[d].normal.y=(n.pageY-c.offsetTop)/c.clientHeight;e[d].viewport.x=2*e[d].normal.x-1;e[d].viewport.y=2*-e[d].normal.y+1;g(e[d]);if(!t){if("mousedown"==b.type||"touchstart"==b.type)f.inUse=
!0;if("mouseup"==b.type||"touchend"==b.type)f.inUse=!1;a&&(f.multi=!1,0==n.length?f.inUse=!1:1<n.length&&(f.multi=!0));e[d].area=0<n.pageX?"right":"left"}},k=function(a,e){for(var d=0,b=a.length;d<b;d++)if(a[d].identifier===e)return!0;return!1};return this instanceof a?this.That:new a};k.addon.runtime.system.knob=function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.runtime.system.subject=
function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.runtime.system.marquee=function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.runtime.system.grid=function(){var a=this.constructor;this.layers={};var f=[],c=[],g=0,m={};this.update=
function(){return this};this.mode=function(a){return this};this.dir=function(a){this.dir=a;return this};this.batches=function(){f=arguments;return this};this.offsets=function(){c=arguments;return this};this.properties=function(a){g=a.count;this.name=a.name;this.columns=a.columns;this.rows=a.rows;m.width=a.width;m.height=a.height;return this};this.syntax=function(a){this.syntax=a;return this};this.assign=function(a){this.assign=a;return this};this.init=function(){for(var a=0;a<f.length;a++){this.batch=
{name:f[a],index:a};this.layers[this.batch.name]={offset:c[a],update:this.update,grid:[]};for(var e=0;e<g;e++){var d=e/this.columns<<0,b=e-d*this.columns;this.layers[this.batch.name].grid[b]||(this.layers[this.batch.name].grid[b]=[]);this.layers[this.batch.name].grid[b][d]={};this.layers[this.batch.name].grid[b][d]=this.assign(this.syntax(e),e,this.batch,b,d,m,this.layers[this.batch.name].grid[b][d])}}return this.layers};for(var k in a)this[k]=a[k];return this instanceof a?this.That:new a};k.addon.runtime.system.grid.parallax=
function(){var a=this.constructor;this.update=function(){return this};this.field=function(a){return this};this.separation=function(){return this};this.update=function(){return this};this.func=function(){return this};this.move=function(){return this};this.init=function(){return this};for(var g in a)this[g]=a[g];return this instanceof a?this.That:new a};k.addon.runtime.system.grid.parallax.entity=function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};
this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.runtime.system.grid.parallax.physic=function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.runtime.system.grid.parallax.bound=function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof
a?this.That:new a};k.addon.runtime.system.grid.parallax.collision=function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.runtime.system.grid.parallax.particle=function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.runtime.system.grid.parallax.rig=
function(){var a=this.constructor;this.bind=function(){return this};this.result=function(a){return this};this.init=function(){return this};return this instanceof a?this.That:new a};k.addon.binding=function(){var a=k.addon.binding={};a.init=function(f,c,l,m,J,A){g.access.defaults.relative=g.access.defaults.relative||!1;g.access.bindings=g[f]=g[f]||{stream:f,data:[],nodesPerStream:0,propsPerNode:m?m.length:l?l.length:0,propDataLength:k.length,propsPerNodeList:[],state:"prebuff",continuancePosValData0:1,
reversion:function(a){return a-this.propDataLength*(a/this.propDataLength<<0)+this.continuancePosValData0}};var e=g.access.bindings.propsPerNodeList,d=e.length-1;g[f].nodesPerStream+=c.length;var b=g[f];b.length=b.length||k.length;b.ids=b.ids||{};var n=k.length;c[0][0].type=c[0][0].type?"position"==c[0][0].type||"rotation"==c[0][0].type||"f"==c[0][0].type||"Vector3"==c[0][0].constructor.name||"Euler"==c[0][0].constructor.name?c[0][0].type:l[0][0]:l[0][0];var p=c[0][0].type=Math.Type.identify(c[0][0]);
a.buffIdKey=a.buffIdKey||800;a.propIdKey="radian"==p?806:801;var t=A||Math.Type.precision(p),E=J||g.access.defaults.relative,B=[];for(J={};0<c.length;)J.buffKey=c[0][1]||a.buffIdKey,J.props="poly"==p?Math.Poly.generate(p,l[0][1],t):Math.Type.convertToPrecisionDataType(p,l.concat(),1,2,t),A="poly"==p?Math.Poly.generateKeys(l[0][1],m?m[m.length-1]:a.propIdKey):m?m.concat():Math.Poly.generateKeys(l,m?m[m.length-1]:a.propIdKey),e[d]!=A.length&&(e[J.buffKey]=A.length),b.propsPerNode=A.length>b.propsPerNode?
A.length:b.propsPerNode,b.ids["_bi"+J.buffKey]=new (function(d){return function(e){c[0][0]=c[0][0]||{};c[0][0][f]={binding:"_bi"+d.buffKey,position:b.data.length,relative:E,conversion:p,precision:t};b.data.push(a.buffIdKey=d.buffKey);a.buffIdKey++;for(var g={};0<d.props.length;)g.propKey=e[0]||a.propIdKey,this[g.propKey]=new (function(a){return function(d){if("poly"!=p&&c[0][0][d[0][0]]&&"undefined"!=typeof c[0][0][d[0][0]].value){this.property=d[0][0];var e="value"}else e=d[0][0];this.binding=e;
d[0][1]=d[0][1]||0;this.value=d[0][1];"poly"!=p&&c[0][0][d[0][0]]&&"undefined"!=typeof c[0][0][d[0][0]].value?c[0][0][d[0][0]].value="value"==d[0][0]?d[0][1]:d[0][1]/t:c[0][0][d[0][0]]="value"==d[0][0]?d[0][1]:d[0][1]/t;c[0][0][f][d[0][0]]={binding:a.propKey,data0PosI:b.data.length+1};b.data.push(a.propKey);b.data.push(1);for(e=0;e<n;e++)d[0][2]?E?b.data.push((d[0][2]-d[0][1])/n):b.data.push(d[0][1]+(d[0][2]-d[0][1])/n*e):E?b.data.push(0):b.data.push(d[0][1])}}(g))(d.props),e.shift(),d.props.shift(),
a.propIdKey=g.propKey,a.propIdKey++,g={propKey:g.propKey};this.node=c[0][0];B.push(this.node)}}(J))(A),c.shift(),J={buffKey:J.buffKey,props:J.props};return B};a.queue=function(){var a="poly"==arguments[2][0][0]?arguments[2][0][1].length:arguments[3]?arguments[3].length:arguments[2]?arguments[2].length:0;this.list=this.list||[];this.list[a]=this.list[a]||[];this.list[a].push(arguments)};a.start=function(g){console.log("Binding objects to stream - Running queue");for(var c=this.list;0<c.length;){if(c[c.length-
1])for(var f=c[c.length-1],m=0;m<f.length;m++)a.init.apply(this,f[m]);c.pop()}g&&g()};return a};k.addon.binding();k.addon.buffer=function(){var a=k.addon.buffer={evals:0};a.update=function(){this.updateCallbacks()};a.updateCalls=[];a.upclen=0;a.updateCallbacks=function(){for(var a=0;a<this.upclen;a++)this.updateCalls[a][1](this.updateCalls[a][0])};a.presets=function(a){for(var d in a)m.presets[d]=a[d]};var f,c,l,m={presets:{}},J=function(a,d,b){for(var e=this.CSPL||{},c=m.presets[a].CPs,g=m.presets[a].duration,
f=m.presets[a].precision,B=c.length,C=[],y=0;y<B;y++)C[y]={t:c[y].t/g*d,p:c[y].p/f*b||c[y].p};d=[];c=[];g=[];for(f=0;f<B;f++)y=C[f],d[f]=y.t,c[f]=y.p,g[f]=1;e.getNaturalKs(d,c,g);f=C[0].t;B=C[B-1].t;for(C=new Int32Array(new ArrayBuffer(4*B));f<=B;f++)C[f]=e.evalSpline(f,d,c,g);return[C,b||m.presets[a].precision]};a.eval=function(e,d,b,n,p,t,E,B,m,y){g.access.defaults.relative=g.access.defaults.relative||!1;b=b||g.access.defaults.relative;for(var C=[],w=0,k=d.length;w<k;w++){var v=d[w];var h=v[0];
var x=v[2];for(var r=v[3],u=[],G=0,I=h.length;G<I;G++){for(var z=h[G],q=v[1],H=0,Q=q.length;H<Q;H++){f=0;if(r)if(1==r)f-=l;else if(1<r||1>r)f+=r;c=0;var F=q[H];u[H]=q[H][0];for(var N=0,R=F.length;N<R;N++){var L=F[N];u[H]=L[0];for(var M=0,k=0,D=x.length;k<D;k++)x[k][1]<<=0,M+=x[k][1];D=0;for(k=x.length;D<k;D++){var P=x[D];l=P[1];L[2]=l/M*L[1];L[2]=Math.Type.convertToPrecisionType(z[e].conversion,L[2]);A(e,z,L,J(P[0],l,n||l),b,y);f+=l;c+=L[2]}}}t&&a.assignLeap(e,[z],u,!1,f,t,E,B,m);p&&(C[G]=a.getData(e,
[z],u,p))}}a.evals+=h.length*x.length;a.update();return C};a.exec=function(e,d,b,n,p,t,k,B,m,y){g.access.defaults.relative=g.access.defaults.relative||!1;b=b||g.access.defaults.relative;for(var E=[],w=0,C=d.length;w<C;w++){for(var v=d[w],h=v[0],v=v[1],x=[],r=0,u=h.length;r<u;r++){for(var G=h[r],I=c=f=0,z=v.length;I<z;I++){var q=v[I],H=q[0],Q=[x[I]=q[1],q[2]],F=[q[3],q[4]];c+=Math.Type.convertToPrecisionType(G[e].conversion,q[5])||0;f=0;if(H)if(1==H)f-=l;else if(1<H||1>H)f+=H;l=F[1];Q[2]=Math.Type.convertToPrecisionType(G[e].conversion,
Q[1]);A(e,G,Q,J(F[0],l,n||l),b,y,!0);f+=l}t&&a.assignLeap(e,[G],[x],!1,f,t,k,B,m);p&&(E[r]=a.getData(e,[G],[x],p))}a.evals+=v.length}a.update();return E};a.execLerp=function(e,d,b,c,f,t,k,B,m,y,l,w,O,v,h,x,r,u,G,I){t="prebuff"==g[e].state?g[e]:g.access;B=t.propDataLength+1;c=c[e][f].data0PosI;l-=y;w=J(w||"linear",l,l);O=O||1;if(d&&b)for(f=0,m=d.length;f<m;f++)for(var n=d[f][e],p=0,E=b.length;p<E;p++)for(var C=n[b[p]].data0PosI,K=t.data[C+y+1],A=0;A<l;A++){var D=y+A,D=D<B?D:t.reversion(D),L=C+D;I&&
t.data[L+1]==t.arguments.leap||(D=Math.lerpSubject(K,t.data[c+D+1],k*(1-(w[1]-w[0][A])/w[1])),K-=D,t.data[L+1]=K*O)}x&&a.assignLeap(e,[d[0]],b,v,h,x,r,u,G);a.evals+=d.length*b.length;a.update()};a.assignLeap=function(a,d,b,c,f,t,k,B,m){for(var e="prebuff"==g[a].state?g[a]:g.access,n=e.propDataLength+1,p=0,E=d.length;p<E;p++)for(var C=d[p][a],h=0,l=b.length;h<l;h++){var r=C[b[h]],u=r.data0PosI,G=e.data[u];if(r.leap&&k){var I=r.leap.dataPosI;e.data[I]=0}r.leap={callback:t,dataPos:c?f:G+f,dispose:"undefined"==
typeof B?!0:B,zeroIn:m};G=r.leap.dataPos;G=G<n?G:e.reversion(G);u+=G;e.data[u]=e.arguments.leap;r.leap.dataPosI=u}};var A=function(e,d,b,n,p,t,k){var m=d[b[0]].value?"value"==b[0]?d[b[0]].value:d[b[0]].value*d[e].precision:"value"==b[0]?d[b[0]]:d[b[0]]*d[e].precision,m=k?c:m+c;d=d[e][b[0]].data0PosI;e="prebuff"==g[e].state?g[e]:g.access;k=e.data[d];k+=f;var C=e.propDataLength+1;b=b[2];var y=n[0];n=n[1];for(var E=y.length,w=0;w<E;w++){var l=k+w,l=l<C?l:e.reversion(l),l=d+l;t&&e.data[l]==e.arguments.leap||
(e.data[l]=p?e.data[l]+((y[w]-(y[w+1]||0))/(n/b)<<0):m+(n-y[w])/n*b<<0)}a.update()};a.zeroOut=function(a,d,b,c,f,k){var e="prebuff"==g[a].state?g[a]:g.access,n=e.propDataLength+1;b-=d;if(c&&f)for(var p=0,y=c.length;p<y;p++)for(var m=c[p][a],t=0,l=f.length;t<l;t++)for(var v=m[f[t]].data0PosI,h=0;h<b;h++){var x=d+h,x=x<n?x:e.reversion(x),x=v+x;k&&e.data[x+1]==e.arguments.leap||(e.data[x+1]=0)}else for(p in e.bindings.ids)for(y in c=e.bindings.ids[p].node[a],c)if(c[y].data0PosI)for(f=c[y].data0PosI,
m=0;m<b;m++)t=d+m,t=t<n?t:e.reversion(t),t=f+t,k&&e.data[t+1]==e.arguments.leap||(e.data[t+1]=0)};a.valIn=function(e,d,b,c,f,t,k,m,l,y,K,w,A,v){var h="prebuff"==g[e].state?g[e]:g.access,n=h.propDataLength+1;if(d&&b)for(var p=0,B=d.length;p<B;p++){var C=d[p][e];k=k||C.precision;for(var E=0,z=b.length;E<z;E++)for(var q=C[b[E]].data0PosI,H=t-f,D=0;D<H;D++){var F=f+D,F=F<n?F:h.reversion(F),F=q+F;v&&h.data[F+1]==h.arguments.leap||(h.data[F+1]=Math.Type.convertToPrecisionType(C.conversion,c,k))}}y&&a.assignLeap(e,
[d[0]],b,m,l,y,K,w,A)};a.getforwardData=function(a,d,b,c,f){for(var e="prebuff"==g[a].state?g[a]:g.access,n=e.propDataLength+1,p=[],k=0,m=d.length;k<m;k++){var l=d[k][a];p[k]={};for(var w=0,A=b.length;w<A;w++)for(var v=b[w],h=l[v].data0PosI,x=e.data[h]+2,r=p[k][v]=0;r<c;r++){var u=x+r,u=u<n?u:e.reversion(u),u=h+u;f&&e.data[u+1]==e.arguments.leap||(p[k][v]+=e.data[u+1]/l.precision)}}return p};a.injectData=function(a,d,b,c,f,k,m,l,C){for(var e="prebuff"==g[a].state?g[a]:g.access,n=e.propDataLength,
p=0,t=d.length;p<t;p++){var v=d[p][a];m*=v.precision;l*=v.precision;for(var h=0,x=b.length;h<x;h++){var r=v["poly"==v.conversion?0:b[h]].data0PosI;var u=e.data[r];for(var B=0;B<f;B++){var E=u+B,E=E<n?E:e.reversion(E);if("poly"==v.conversion)for(var z=0,x=c.length;z<x;z++){r=v[z].data0PosI;var q=r+E;C&&e.data[q]==e.arguments.leap||(e.data[q]=k?c[z]*v.precision+e.data[q]:c[z]*v.precision,e.data[q]=e.data[q]<m?m:e.data[q]>l?l:e.data[q])}else q=r+E,C&&e.data[q]==e.arguments.leap||(e.data[q]=k?c*v.precision+
e.data[q]:c*v.precision,e.data[q]=e.data[q]<m?m:e.data[q]>l?l:e.data[q])}}}};a.queue=function(){this.list=this.list||[];this.list.push(arguments);return this.list.length-1};a.start=function(e){console.log("Buffering binded objects in stream - Running queue");for(var d=this.list;0<d.length;){var b=Array.prototype.shift.apply(d[0]);a[b].apply(this,d[0]);d.shift()}e&&e()};a.loadData=function(e,d,b,c,f,g){console.log("Loading in data and buffing objects in stream - "+d);var n=new window.XMLHttpRequest;
n.open("GET",d,!0);n.responseType="text";n.callback=c;n.onload=function(){var d=this.response,d=d.split(","),c=Array.prototype.shift.apply(d),n=Array.prototype.shift.apply(d);a.buffinData(e,d,b,f||c<<0,g||n<<0);this.callback&&this.callback()};n.send()};a.buffinData=function(a,d,b,c,f){for(var e,n,k=g[a].state,p="prebuff"==k?g[a]:g.access,m=1+f,l=0,w=0,A=0;l<d.length;l++){0==(l-0)%c&&(n=d[l],l++,w=1,A++);0==(l-A)%m&&(e=d[l],l++,w++,A++);for(var v="prebuff"==k?p.ids["_bi"+n]:p.bindings.ids["_bi"+n],
v=v.node[a][v[e].binding].data0PosI,h=0;h<f;h++)p.data[v+b+h]=d[l],l++}};a.getData=function(e,d,b,c,f,k,l){k="prebuff"==g[e].state?g[e]:g.access;f=f?f<c||f>k.propDataLength?k.propDataLength:f:k.propDataLength;c=c?f&&c>f||c>k.propDataLength?0:c:0;return a.buffoutData(e,d,b,c,f)};a.saveData=function(a,d){var b=document.createElement("a");document.body.appendChild(b);b.style="display: none";return function(a,d){var c=new window.Blob([[a]],{type:"octet/stream"}),c=window.URL.createObjectURL(c);b.href=
c;b.download=d;b.click();window.URL.revokeObjectURL(c)}}();a.buffoutData=function(a,d,b,c,f){var e="prebuff"==g[a].state?g[a]:g.access;f-=c;var n=1+f,k=b?n*b.length+b.length+1:0,l=[k,f];if(d)for(var m=0,p=d.length;m<p;m++){var w=d[m][a];if(!b){b=[];for(var A in w)"undefined"!=typeof d[m][A]&&b.push(A)}0==k&&(k=n*b.length+b.length+1,l=[k,f]);l.push(w.binding.replace("_bi","")<<0);for(var v=0,h=b.length;v<h;v++){var x=w[b[v]];l.push(x.binding);x=x.data0PosI;l.push(e.data[x+c]);for(var r=0;r<f;r++){var u=
c+r,u=u<e.propDataLength?u:e.reversion(u);l.push(e.data[x+u+1])}}}return l};return a};var T=k.addon.buffer();k.addon.buffer.ease=function(){var a=k.addon.buffer.ease={};a.precisions=100;a.update=function(){f=this.precisions;var a=c.precisions,g;for(g in c){for(var k in c[g].CPs)c[g].CPs[k].p=c[g].CPs[k].p/a*f;c[g].duration=c.durations;c[g].precision=f}c.precisions=f;T.presets(c);this.updateCallbacks()};a.updateCalls=[];a.upclen=0;a.updateCallbacks=function(){for(var a=0;a<this.upclen;a++)this.updateCalls[a][1](this.updateCalls[a][0])};
var f=a.precisions;var c={durations:100,precisions:100,linear:{CPs:[{t:0,p:100},{t:50,p:50},{t:100,p:0}]},easeInSine:{CPs:[{t:0,p:100},{t:17,p:96},{t:100,p:0}]},easeOutSine:{CPs:[{t:0,p:100},{t:83,p:3},{t:100,p:0}]},easeInOutSine:{CPs:[{t:0,p:100},{t:19,p:92},{t:81,p:8},{t:100,p:0}]},easeInQuad:{CPs:[{t:0,p:100},{t:32,p:89},{t:75,p:44},{t:100,p:0}]},easeOutQuad:{CPs:[{t:0,p:100},{t:17,p:69},{t:74,p:6},{t:100,p:0}]},easeInOutQuad:{CPs:[{t:0,p:100},{t:17,p:93},{t:35,p:75},{t:55,p:40},{t:80,p:7},{t:100,
p:0}]},easeInCubic:{CPs:[{t:0,p:100},{t:17,p:99},{t:42,p:92},{t:66,p:71},{t:86,p:35},{t:100,p:0}]},easeOutCubic:{CPs:[{t:0,p:100},{t:15,p:59},{t:33,p:30},{t:57,p:8},{t:83,p:0},{t:100,p:0}]},easeInOutCubic:{CPs:[{t:0,p:100},{t:22,p:96},{t:38,p:77},{t:50,p:50},{t:64,p:18},{t:82,p:2},{t:100,p:0}]},easeInQuart:{CPs:[{t:0,p:100},{t:21,p:100},{t:42,p:96},{t:63,p:84},{t:82,p:54},{t:92,p:28},{t:100,p:0}]},easeOutQuart:{CPs:[{t:0,p:100},{t:12,p:58},{t:27,p:28},{t:45,p:9},{t:66,p:1},{t:81,p:0},{t:100,p:0}]},
easeInOutQuart:{CPs:[{t:0,p:100},{t:15,p:100},{t:28,p:94},{t:41,p:76},{t:50,p:49},{t:57,p:26},{t:68,p:8},{t:84,p:0},{t:100,p:0}]},easeInQuint:{CPs:[{t:0,p:100},{t:24,p:100},{t:43,p:98},{t:64,p:89},{t:81,p:64},{t:93,p:28},{t:100,p:0}]},easeOutQuint:{CPs:[{t:0,p:100},{t:9,p:61},{t:23,p:26},{t:37,p:10},{t:59,p:1},{t:78,p:0},{t:100,p:0}]},easeInOutQuint:{CPs:[{t:0,p:100},{t:16,p:99},{t:28,p:96},{t:45,p:70},{t:52,p:39},{t:60,p:17},{t:75,p:1},{t:88,p:0},{t:100,p:0}]},easeInExpo:{CPs:[{t:0,p:100},{t:9,p:99},
{t:56,p:94},{t:72,p:85},{t:83,p:69},{t:92,p:42},{t:100,p:0}]},easeOutExpo:{CPs:[{t:0,p:100},{t:5,p:70},{t:22,p:21},{t:48,p:3},{t:64,p:1},{t:93,p:0},{t:100,p:0}]},easeInOutExpo:{CPs:[{t:0,p:100},{t:11,p:99},{t:21,p:99},{t:30,p:96},{t:38,p:90},{t:47,p:67},{t:53,p:33},{t:60,p:12},{t:72,p:2},{t:79,p:0},{t:85,p:0},{t:100,p:0}]},easeInCirc:{CPs:[{t:0,p:100},{t:33,p:94},{t:54,p:83},{t:81,p:58},{t:94,p:35},{t:99,p:10},{t:100,p:0}]},easeOutCirc:{CPs:[{t:0,p:100},{t:1,p:90},{t:6,p:66},{t:14,p:48},{t:26,p:32},
{t:41,p:19},{t:60,p:8},{t:79,p:2},{t:100,p:0}]},easeInOutCirc:{CPs:[{t:0,p:100},{t:17,p:97},{t:27,p:92},{t:37,p:83},{t:44,p:74},{t:47,p:67},{t:49,p:60},{t:50,p:50},{t:51,p:41},{t:53,p:31},{t:57,p:22},{t:62,p:17},{t:71,p:9},{t:82,p:3},{t:100,p:0}]},easeInBack:{CPs:[{t:0,p:100},{t:4,p:100},{t:64,p:100},{t:86,p:53},{t:100,p:0}]},easeOutBack:{CPs:[{t:0,p:100},{t:3,p:86},{t:35,p:1},{t:95,p:0},{t:100,p:0}]},easeInOutBack:{CPs:[{t:0,p:100},{t:3,p:100},{t:46,p:69},{t:51,p:44},{t:56,p:22},{t:97,p:0},{t:100,
p:0}]},easeInElastic:{CPs:[{t:0,p:100},{t:8,p:99},{t:15,p:99},{t:22,p:100},{t:32,p:100},{t:41,p:98},{t:47,p:99},{t:63,p:99},{t:74,p:90},{t:93,p:93},{t:95,p:60},{t:100,p:0}]},easeOutElastic:{CPs:[{t:0,p:100},{t:3,p:65},{t:7,p:2},{t:26,p:11},{t:38,p:0},{t:56,p:1},{t:69,p:0},{t:75,p:0},{t:83,p:0},{t:90,p:0},{t:100,p:0}]},easeInOutElastic:{CPs:[{t:0,p:100},{t:13,p:100},{t:23,p:99},{t:33,p:99},{t:45,p:95},{t:48,p:67},{t:51,p:41},{t:55,p:4},{t:67,p:0},{t:78,p:0},{t:87,p:0},{t:100,p:0}]},easeInBounce:{CPs:[{t:0,
p:100},{t:4,p:98},{t:8,p:100},{t:12,p:96},{t:23,p:97},{t:26,p:100},{t:28,p:96},{t:60,p:95},{t:63,p:100},{t:68,p:80},{t:87,p:13},{t:100,p:0}]},easeOutBounce:{CPs:[{t:0,p:100},{t:15,p:83},{t:28,p:40},{t:33,p:17},{t:36,p:2},{t:38,p:4},{t:71,p:4},{t:73,p:0},{t:77,p:4},{t:88,p:3},{t:91,p:0},{t:94,p:1},{t:100,p:0}]},easeInOutBounce:{CPs:[{t:0,p:100},{t:3,p:98},{t:5,p:99},{t:9,p:97},{t:13,p:99},{t:16,p:94},{t:28,p:94},{t:31,p:98},{t:37,p:77},{t:44,p:55},{t:55,p:46},{t:64,p:19},{t:68,p:1},{t:72,p:6},{t:82,
p:7},{t:86,p:0},{t:91,p:3},{t:95,p:0},{t:97,p:1},{t:100,p:0}]}};a.update()};k.addon.buffer.ease();k.addon.timeframe=function(){var a=k.addon.timeframe={};a.process=void 0;a.invoke=void 0;a.length=void 0;a.init=!1;a.ready=!1;a.running=!1;a.control=!1;a.lapse=10;a.duration=a._duration=0;a.read=0;a.thrust=0;a.mode="2d";a.runtime=function(){this.runtimeCallbacks()};a.runtimeAuthority=function(a,b,c){g[b].script[c]=a};a.clearRuntimeAuthority=function(a,b){isNaN(b)?g[a].script=[]:g[a].script[b]&&g[a].script.splice(b,
1)};a.clearRuntimeAuthoritiesNear=function(a,b,c){this.timeline.removeInsertsNear(a,b,c);var d=b+c;for(b-=c;b<d;b++)this.clearRuntimeAuthority(a,b)};a.revert=function(a){this.revertCallbacks(a)};a.revertCalls=[];a.rrclen=0;a.revertCallbacks=function(a){for(var b=0;b<this.rrclen;b++)this.revertCalls[b][1](this.revertCalls[b][0],a)};var f=function(d){a.revert(d)};a.update=function(d){c.process=this.process;c.invoke=this.invoke;c.length=this.length;c.running=this.running;c.lapse=this.lapse;this.updateCallbacks&&
this.updateCallbacks();"3d"==a.mode?(m(),A()):(D(),e());d=d?d-1:void 0;g.access.option=c.access;g.access.method="all";g.access.rCount=g.access.tCount=1;d&&a.syncing(d);g.access.output_revertCall=f};a._init=function(a){this.mode="CanvasRenderingContext2D"==a.canvases["0"].context.constructor.name?"2d":"3d";this.length=g[g.access.stream].length;this.init=!0};a._forceInit=function(a){this.mode="CanvasRenderingContext2D"==a.canvases["0"].context.constructor.name?"2d":"3d";this.length=g.access.access.prototype.length;
this.init=!0};a._ready=function(){this.ready=!0};a.run=function(){!this.running&&this.ready&&(c.now=c._then=Date.now(),this.length=g[g.access.stream]?g[g.access.stream].length:this.length,this.running=!0,this.update(),l())};a.stop=function(a){this.running&&(this.running=!1,this.update(),window.cancelAnimationFrame(c.animationFrameLoop));a&&(this.duration=a,this.syncing())};a.tick=function(a,b){c.byFrame.exact=a||c.byFrame.exact;c.byFrame.number=b||1;this.running=!1;this.run()};a.keyPauseToggle=function(a){a&&
(console.log("KeyCode:"+a.keyCode),32==a.keyCode&&(this.running?this.stop():this.run()))};a.syncing=function(a){g.access.syncOffsets(a||this.duration)};var c={_then:Date.now(),access:"read",_remain:0,lapse:a.lapse,byFrame:{number:0,exact:!1},frame:a},l=function(){c.running&&(window.stats.begin(),c.now=Date.now(),c._delta=c.now-c._then+c._remain,a[c.access]=c._timeFrame=c._delta/10<<0,a._duration=a.duration+c._timeFrame,c.process(),c._remain=c._delta-10*c._timeFrame,c._then=c.now,0<c._timeFrame&&c._timeFrame<
c.lapse&&(a.runtime(),c.byFrame.exact?c.byFrame.exact&&(g.access.process(1),c.byFrame.exact=!1,c.byFrame.number=0,a.stop()):(g.access.process(c._timeFrame),0<c.byFrame.number&&(1==c.byFrame.number&&a.stop(),c.byFrame.number--),a.duration+=c._timeFrame),c.invoke()),c.animationFrameLoop=window.requestAnimationFrame(l),window.stats.end())};a.switchToTimeFrameThrusting=function(a){c.access="thrust";g.access.defaults.relative=!0;g.access.block=!0;this.update(a)};var m=function(){g.access.output_utilizeThrustData=
function(a,b,c){if(0!=a||806==c){b=this.bindings.ids["_bi"+b];var d=b[c];d.value+=a;d.property?b.node[d.property][d.binding]=d.value/b.node[this.stream].precision:b.node[d.binding]=d.value/b.node[this.stream].precision;806==c&&(b.node.blockCallback=!1)}}},D=function(){g.access.output_utilizeThrustData=function(a,b,c){0!=a&&(b=this.bindings.ids["_bi"+b],c=b[c],c.value+=a,c.property?b.node[c.property][c.binding]=c.value/b.node[this.stream].precision:b.node[c.binding]=c.value/b.node[this.stream].precision)}};
a.switchToTimeFrameReading=function(a){c.access="read";g.access.defaults.relative=!0;g.access.block=!0;this.update(a)};var A=function(){g.access.output_utilizeReadData=function(a,b,c){b=this.bindings.ids["_bi"+b];var d=b[c];d.value=a;d.property?b.node[d.property][d.binding]=d.value/b.node[this.stream].precision:b.node[d.binding]=d.value/b.node[this.stream].precision;806==c&&(b.node.blockCallback=!1)}},e=function(){g.access.output_utilizeReadData=function(a,b,c){b=this.bindings.ids["_bi"+b];c=b[c];
c.value=a;c.property?b.node[c.property][c.binding]=c.value/b.node[this.stream].precision:b.node[c.binding]=c.value/b.node[this.stream].precision}};a.resetStreamProperties=function(){g.access.revertFromTo(this.length,0)};return a};for(var P=k.addon.timeframe(),M=["comment","segment","action","sound"],D={ci:0};D.ci<M.length;D={ci:D.ci},D.ci++)k.addon.timeframe[M[D.ci]]=function(a){return function(){var f=g[M[a.ci]]={script:[]};f.accessRuntime=void 0;f.runtime=function(a,g,k){if(!P.control){for(g+=k;a<
g;a++)f.script[a]&&f.script[a].main();return f.checkNext(g)}};f.accessRevert=void 0;f.revert=function(a,g){if(!P.control)return f.checkNext(a)};f.checkNext=function(a){for(var c=g.access.propDataLength,k=a;k<f.script.length;k++)f.script[k]&&(k<c||c<a)&&(c=k);return c}}}(D),k.addon.timeframe[M[D.ci]]()});